\chapter{Results}

In this chapter we will study different data sets using the two presented methods for the \textit{BGSEES} algorithm: the \textbf{Least Squares} and \textbf{Decrease Range} method. 

The aim of the chapter is to test them against each other and using different parameters to see which method yields the best result

The algorithm is tested using data from both Solar flares and flares from far-away stars. Because the day hemisphere has to be discarded in order to study far-away stars (because of the Sun's effect on the ionosphere), the first section will study examples of flares originating from the Sun and the second those from outside the Solar System.

\section{Sun}

Below is the list of the different flares we studied. These flares were listed in the paper "" referencia. We obtained the ti file from the entire day and then filtered the data around the time of the flare (30 minutes before and after.)

\begin{itemize}
	\item X17: The X17.2 flare from the Halloween Solar Storm, studied in previous chapters
	\item 
\end{itemize}

To perform this study, the best epoch is found using the mean VTEC, as shown in chapter 5. The data is then filtered using this epoch and the algorithm is executed using the necessary parameters, the studied factors are:

The \textbf{execution time} of the algorithm and the \textbf{absolute error} of the estimation, obtained by computing the angle between correct Sun position\footnote{The correct Sun position at that moment is obtained from the data, it is one of the many fields the ti files contain} and the estimated location, using the same operations we've used in previous chapters to compute the angle. 

The ti files that contain data for the entire day are filtered using this bash script, which has a list with the information of each file to be filtered: the name of the original file and the upper and lower limits of time. It then filters each file using a simple AWK one-line script that checks the field with the time:

\begin{minipage}{\linewidth}
	\begin{lstlisting}[language=Bash, caption=Filtering the ti file]
	#!/bin/bash	
	
	strings=(
	'ti.2003.301.gz,10,11.5'
	)
	for i in "${strings[@]}"; do
	
	done
	
	\end{lstlisting}
\end{minipage}

The study is divided in three categories, based on the method used to discard outliers from the input data:

\begin{itemize}
	\item Using the data from \textbf{all IPPs} without filtering out any outliers
	\item Using a simple \textbf{cutoff value} for the VTEC
	\item Using \textbf{linear fit} for the Decreasing Range method to discard outliers and \textbf{multiple iterations} for the Least Squares method to try to improve the solution, both explained in their respective chapters.
\end{itemize}

\section{Using all available data}

The main problem of this method is that outliers that are far from the sample make the mean computation unstable, leading to using incorrect epochs.

\subsubsection{Decreasing range}

\begin{table}[h!]
	\centering
	\def\arraystretch{1.2}
	\begin{tabular}{|c c c|} 
		\hline
		Data set & Total estimation error & Time \\ [0.5ex] 
		\hline\hline
		X17.2  & 4.09113 & 0.79132 \\
		\hline
		Other & 181.501 & 5.17015 \\
		\hline\hline
		Total & 4.09113 & 6565 \\
		\hline
	\end{tabular}
	\caption{Results for different epochs}
\end{table}

\subsubsection{Least Squares}

\begin{table}[h!]
	\centering
	\def\arraystretch{1.2}
	\begin{tabular}{|c c c c c|} 
		\hline
		Data set & Right Ascension Error & Declination Error & Total estimation error & Time \\ [0.5ex] 
		\hline\hline
		X17.2 & 3.31917 & 0.771964 & 4.09113 & 0.79132 \\
		\hline
		Other & 97.1888 & 84.3119 & 181.501 & 5.17015 \\
		\hline\hline
		Total & 4343 & 5454 & 4.09113 & 6565 \\
		\hline
	\end{tabular}
	\caption{Results for different epochs}
\end{table}

\subsubsection{Discussion}

As we can see

\subsection{Direct VTEC filter}

This is the first method used in the brute force approach that yielded results very similar to the real location of the Sun, but it does not work well with other data sets.

The filter is done using a cutoff value for the VTEC when the data is first filtered

Different cutoff values are studied to see if this is a reliable method, as it simplifies the overall computation of the algorithm considerably.

\subsection{Discarding outliers}

\subsubsection{Decreasing range: linear fit}

\subsubsection{Least Squares: Iteration}

We iterate bla bla bla

\begin{table}[h!]
	\centering
	\def\arraystretch{1.2}
	\begin{tabular}{|c c c c c c|} 
		\hline
		Data set & Iterations & RA Error & Declination Error & Total estimation error & Time \\ [0.5ex] 
		\hline\hline
		X17.2 & 10 & 3.31917 & 0.771964 & 4.09113 & 0.79132 \\
		\hline
		X17.2 & 5 & 3.31917 & 0.771964 & 4.09113 & 0.79132 \\
		\hline
		Other & 10 & 97.1888 & 84.3119 & 181.501 & 5.17015 \\
		\hline\hline
		Total & 10 & 4343 & 5454 & 4.09113 & 6565 \\
		\hline
	\end{tabular}
	\caption{Results for different epochs}
\end{table}

\subsection{Results}

\section{Far-away stars}

\subsection{Used data sets}








\clearpage
\clearpage

\section{Sun}

the two data sets for the best epoch

the first one, study all epochs and see what happens even when there's no flare

\subsection{Decrease range method}

Instead of focusing on only the best epoch\footnote{The best epoch is the one with the highest mean VTEC of all its IPPs}, the following table presents the 15 best epochs from best to worst (with 11.05 at the top, the one studied in previous chapters) and their results: 

\begin{itemize}
	\item The right ascension and declination of the estimated source location (the Sun in this case)
	\item The error of the previous results compared to the real Sun's location
	\item The Pearson correlation coefficient of the estimated Sun
\end{itemize}

\begin{table}[h!]
	\centering
	\def\arraystretch{1.2}
	\begin{tabular}{|c c c c c c|} 
		\hline
		\textbf{Epoch} & RA & Dec & RA Error & Dec Error & Correlation Coefficient \\ [0.5ex] 
		\hline\hline
		11.05 & 213.75 & -10.3125 & 1.412 & 2.7475 & 0.949659 \\ 
		\hline
		11.075 & 215.625 & -12.1875 & 3.287 & 0.8725 & 0.910935 \\ 
		\hline
		11.0417 & 210.938 & -9.375 & 1.4005 & 3.685 & 0.941128 \\ 
		\hline
		11.1167 & 211.875 & -19.6875 & 0.463 & 6.6275 & 0.669265 \\ 
		\hline
		11.0333 & 225.938 & -18.75 & 13.5995 & 5.69 & 0.564307 \\ 
		\hline
		11.025 & 219.375 & -16.875 & 7.037 & 3.815 & 0.49188 \\ 
		\hline
		11.0917 & 216.562 & -21.5625 & 4.2245 & 8.5025 & 0.48441 \\ 
		\hline
		11.1333 & 214.688 & -23.4375 & 2.3495 & 10.3775 & 0.397166 \\ 
		\hline
		11.1917 & 211.875 & -11.25 & 0.463 & 1.81 & 0.355636 \\ 
		\hline
		11.3667 & 185.625 & -76.875 & 26.713 & 63.815 & 0.23138 \\ 
		\hline
		10.8583 & 20.625 & -65.625 & 191.713 & 52.565 & 0.112926 \\ 
		\hline
		11.1583 & 211.875 & -32.8125 & 0.463 & 19.7525 & 0.29224 \\ 
		\hline
		10.9917 & 62.8125 & -71.25 & 149.525 & 58.19 & 0.130575 \\ 
		\hline
		11.0167 & 203.438 & 8.4375 & 8.9005 & 21.4975 & 0.211087 \\ 
		\hline
		11.4583 & 235.312 & -37.5 & 22.9745 & 24.44 & 0.137234 \\
		\hline
	\end{tabular}
	\caption{Results for different epochs}
\end{table}




\section{Far-away stars}
